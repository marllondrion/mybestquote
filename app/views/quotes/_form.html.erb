<div id="form-frame">
  <%= form_with(model: quote, data: { turbo: true }, class: "space-y-8") do |f| %>
    <div class="lg:col-span-2 space-y-2">
      <%= f.label :age, "Traveller's Age", class: "block text-sm font-semibold text-gray-900" %>
      <%= f.number_field :age, min: 0, max: 84, placeholder: "e.g. 28",
                         class: "block w-full rounded-xl border-0 py-3.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6 bg-gray-50" %>
      <p class="text-xs text-gray-500">
        Must be under 85. Children under 16 travel free.
      </p>
    </div>

    <div class="lg:col-span-5 space-y-2">
      <%= f.label :trip_type_id, "Trip Type", class: "block text-sm font-semibold text-gray-900" %>
      <div class="flex flex-row gap-4">
        <%= render "shared/radio_card_group",
                   form: f,
                   field: :trip_type_id,
                   collection: @trip_types,
                   value_method: :id,
                   text_method: :label %>
      </div>
    </div>

    <div class="w-full max-w-2xl">
      <%= f.label :excess_id, "Select Excess Level", class: "text-sm font-semibold text-gray-900 mb-3 block" %>
      <div class="flex flex-row gap-4">
        <%= render "shared/radio_card_group",
                   form: f,
                   field: :excess_id,
                   collection: @excesses,
                   value_method: :id,
                   text_method: :label %>
      </div>
    </div>

    <div class="grid grid-cols-2 gap-6">
      <div class="space-y-2">
        <%= f.label :start_date, "Departure", class: "block text-sm font-semibold text-gray-900" %>
        <%= f.date_field :start_date, min: Date.today, max: trip_date_max, value: f.object.start_date || Date.today,
                         class: "block w-full rounded-xl border-0 py-3.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm bg-gray-50" %>
      </div>

      <div class="space-y-2">
        <%= f.label :end_date, "Return", class: "block text-sm font-semibold text-gray-900" %>
        <%= f.date_field :end_date, min: Date.today, value: f.object.end_date || Date.today, max: trip_date_max,
                         class: "block w-full rounded-xl border-0 py-3.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm bg-gray-50" %>
      </div>
    </div>

    <div class="space-y-3 pt-2">
      <%= f.label :destination_ids, "Where are you travelling?", class: "block text-sm font-semibold text-gray-900" %>

      <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 max-h-60 overflow-y-auto p-1">
        <% @destinations.each do |dest| %>
          <label class="relative flex items-center p-4 rounded-xl border border-gray-200 hover:border-indigo-600 hover:bg-indigo-50/50 cursor-pointer transition-all group">
            <div class="flex h-5 w-5 items-center justify-center">
              <%= f.check_box :destination_ids, { multiple: true, class: "h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-600 group-hover:border-indigo-600" }, dest.id, nil %>
            </div>
            <span class="ml-3 text-sm font-medium text-gray-900 group-hover:text-indigo-700"><%= dest.label %></span>
          </label>
        <% end %>
      </div>
      <p class="text-xs text-gray-500">Select all countries you plan to visit.</p>
    </div>

    <%= f.hidden_field :cover_id, value: @covers&.first&.id %>

    <div class="pt-6">
      <%= f.submit "Calculate Premium",
                   class: "flex w-full justify-center rounded-xl bg-indigo-600 px-3 py-4 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 transition-colors text-lg" %>
    </div>
  <% end %>
</div>